# Итоговый проект по Python
---

## Запуск

### 1. Инициализация Airflow
Выполните следующую команду для инициализации Airflow:
```bash
docker compose -f docker-compose.init.yaml up
```

### 2. Поднятие сервисов Airflow, Postgres, MySQL
Чтобы запустить необходимые сервисы, выполните:
```bash
docker compose up
```
---

## Airflow Dags

### Вход в Airflow
Перейдите по адресу: [http://localhost:8080/](http://localhost:8080/).  
Учетные данные для входа:
- **Логин:** `admin`
- **Пароль:** `admin`

### Описание доступных DAG-ов

#### 1. **`1_Initial_Migration`**
- Запускается **один раз** при первом запуске для инициализации таблиц и данных.
- Функциональность:
  - Создание таблиц в Postgres и MySQL.
  - Загрузка первичных данных в Postgres.

#### 2. **`2_Transfer_Data_Postgres_to_MySQL`**
- Функциональность:
  - Репликация данных из Postgres в MySQL.
- **Настройка таблиц и полей для репликации**:
  - Содержится в файле `./airflow_dags/tables_to_replicate.yaml`.

#### 3. **`3_Create_MySQL_Vitrina`**
- Функциональность:
  - Построение аналитической витрины `Vitrina`.

---


# Аналитическая витрина `Vitrina`

## Описание
Витрина `Vitrina` создана для объединения данных о
- пользователях
- заказах
- продуктах
- и категориях

в единую таблицу.

### Основные цели:
- Оценка доходов по продуктам, категориям и клиентам.
- Выявление самых прибыльных клиентов и наиболее продаваемых продуктов.

## Структура витрины

| Поле | Описание |
| --- | --- |
| **user_id**                 | ID пользователя                   |
| **full_name**               | Полное имя клиента                |
| **email**                   | Email клиента                     |
| **phone**                   | Телефон клиента                   |
| **loyalty_status**          | Статус лояльности клиента         |
| **order_id**                | ID заказа                         |
| **order_date**              | Дата размещения заказа            |
| **order_total**             | Общая сумма заказа                |
| **product_id**              | ID продукта                       |
| **product_name**            | Название продукта                 |
| **category_name**           | Название категории продукта       |
| **quantity**                | Количество купленного продукта    |
| **price_per_unit**          | Цена за единицу продукта          |
| **total_price_per_product** | Общая стоимость продукта          |
| **order_status**            | Статус заказа                     |

